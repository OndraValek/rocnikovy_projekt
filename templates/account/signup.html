{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load socialaccount %}

{% block title %}Registrace{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
        <div class="card shadow">
            <div class="card-body p-5">
                <h2 class="card-title text-center mb-4">Registrace</h2>
                
                {% if form.errors %}
                    <div class="alert alert-danger" role="alert">
                        <strong>Chyba:</strong> Zkontrolujte prosím své údaje.
                    </div>
                {% endif %}

                <!-- OAuth2 tlačítka -->
                <div class="mb-4">
                    <p class="text-center text-muted mb-3">Nebo se zaregistrujte pomocí:</p>
                    <div class="d-grid gap-2">
                        {% get_providers as socialaccount_providers %}
                        
                        {% if 'google' in socialaccount_providers %}
                        <a href="{% provider_login_url 'google' %}" class="btn btn-outline-danger">
                            <svg width="18" height="18" viewBox="0 0 18 18" class="me-2">
                                <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z"/>
                                <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.965-2.184l-2.908-2.258c-.806.54-1.837.86-3.057.86-2.35 0-4.34-1.587-5.053-3.72H.957v2.332C2.438 15.983 5.482 18 9 18z"/>
                                <path fill="#FBBC05" d="M3.952 10.698c-.18-.54-.282-1.117-.282-1.698s.102-1.158.282-1.698V4.97H.957C.348 6.175 0 7.55 0 9s.348 2.825.957 4.03l3.005-2.332z"/>
                                <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.97L3.952 7.302C4.66 5.167 6.65 3.58 9 3.58z"/>
                            </svg>
                            Registrovat se přes Google
                        </a>
                        {% endif %}
                        
                        {% if 'github' in socialaccount_providers %}
                        <a href="{% provider_login_url 'github' %}" class="btn btn-outline-dark">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" class="me-2">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            Registrovat se přes GitHub
                        </a>
                        {% endif %}
                        
                        {% if 'microsoft' in socialaccount_providers %}
                        <a href="{% provider_login_url 'microsoft' %}" class="btn btn-outline-primary">
                            <svg width="18" height="18" viewBox="0 0 23 23" class="me-2">
                                <path fill="#f25022" d="M0 0h11.377v11.372H0z"/>
                                <path fill="#00a4ef" d="M12.623 0H24v11.372H12.623z"/>
                                <path fill="#7fba00" d="M0 12.628h11.377V24H0z"/>
                                <path fill="#ffb900" d="M12.623 12.628H24V24H12.623z"/>
                            </svg>
                            Registrovat se přes Microsoft
                        </a>
                        {% endif %}
                    </div>
                </div>

                {% if socialaccount_providers %}
                <hr class="my-4">
                <p class="text-center text-muted mb-3">Nebo se zaregistrujte pomocí emailu:</p>
                {% endif %}

                <!-- Klasická registrace -->
                <form method="post" action="{% url 'account_signup' %}">
                    {% csrf_token %}
                    {{ form|crispy }}
                    {% if redirect_field_value %}
                        <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
                    {% endif %}
                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn btn-primary">Registrovat se</button>
                    </div>
                </form>

                <hr class="my-4">
                <p class="text-center mb-0">
                    Už máte účet? <a href="{% url 'account_login' %}">Přihlaste se</a>
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

